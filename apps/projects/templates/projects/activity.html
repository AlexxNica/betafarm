{% extends "base.html" %}
{% from "layout/breadcrumbs.html" import breadcrumbs %}
{% from "layout/helpers.html" import sectiontitle, subnav with context %}
{% from "activity/helpers.html" import activity with context %}

{% block page_title -%}
  {{ _('Activity : {project} : Projects : Mozilla Betafarm')|f(project=project.name) }}
{% endblock -%}

{% block page_id %}project_blog{% endblock %}
{% block section_class %}projects{% endblock %}

{% block breadcrumbs -%}
  {{ breadcrumbs(
       (url('innovate_splash'), _('Betafarm Home')),
       (url('projects_all'), _('Projects')),
       (url('projects_show', slug=project.slug), project.name),
       last=_('Activity')) }}
{% endblock -%}

{% set navlinks = ((url('projects_show', slug=project.slug), _('Info'), False),
                   (url('projects_activity', slug=project.slug), _('Activity'), True)) %}

{% if user.get_profile() in project.followers.all() -%}
{% set buttons = ((url('projects_unfollow', slug=project.slug), _('Unfollow'), 'unsubmit'),) %}
{% else -%}
{% set buttons = ((url('projects_follow', slug=project.slug), _('Follow'), 'submit'),) %}
{% endif -%}

{% block content -%}
{{ sectiontitle(_('{project} Activity')|f(project=project.name)) }}
{{ subnav(MEDIA_URL, project.image_or_default, navlinks, project.other_links, True, buttons) }}

<section id="activity" class="clearfix">
  {% if activities.object_list -%}
  <ul class="activityStream">
    {% for obj in activities.object_list -%}
      {{ activity(obj) }}
    {% endfor -%}
  </ul>

  {% if activities.has_next() -%}
    <div class="c1"></div>
    <div class="c4">
      <button class="sans" style="width:100%">{{ _('load older') }}</button>
    </div>
  {% endif -%}

  {% else -%}
    <div class="paper c3">
      <h3>{{ _('Waiting for content &hellip;') }}</h3>
      <p>{{ _('No posts yet! Check back though, I\'m sure we\'ll have something soon!') }}</p>
    </div>
  {% endif -%}
</section>

{% endblock -%}
